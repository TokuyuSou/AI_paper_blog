{
  "title": "Paper Explained: Function-Space Decoupled Diffusion for Forward and Inverse Modeling in Carbon Capture and Storage - A Beginner's Guide",
  "subtitle": "A new path to predicting underground carbon storage",
  "category": "Foundation Models",
  "authors": [
    "Xin Ju",
    "Jiachen Yao",
    "Anima Anandkumar",
    "Sally M. Benson",
    "Gege Wen"
  ],
  "paper_url": "https://arxiv.org/abs/2602.12274v1",
  "read_time": "10 min read",
  "publish_date": "2026-02-15",
  "concept_explained": "Function-space Diffusion",
  "content": {
    "background": "Subsurface modeling for Carbon Capture and Storage (CCS) is about figuring out what the underground rocks and fluids look like from only a few measurements on the surface or in a few wells. The big problem is ill-posed: many different underground layouts can produce the same limited data. The geology is also highly variable and messy, so small changes can drastically affect how fluids move. Because observations are sparse and noisy, traditional methods often give uncertain or misleading results, which is risky when making decisions about storing carbon underground.\n\nPeople have tried to fix this by using prior knowledge about likely geologies (learning “typical” patterns of rock layers) and by building fast surrogate models to predict what happens under different conditions. But with very little data, these approaches can still miss important details, and they often produce results that look physically plausible in some places but jump with unrealistic, high-frequency patterns somewhere else. Validating whether the inferred underground states are truly correct is also hard: the most trustworthy check, rejection sampling, is accurate but prohibitively slow for practical use.\n\nAll of this created a clear motivation for a new approach. Researchers wanted a way to incorporate realistic geological patterns as a prior, while also using physics-based guidance to make efficient, data-driven inferences from sparse observations. They needed methods that (a) can recover missing information in a way that stays faithful to real rock behavior, (b) avoid making the artwork look jagged or artificial, and (c) be fast enough to test and use in real CCS scenarios. In short, the goal was to make uncertain, ill-posed subsurface problems more tractable and trustworthy when data is scarce.",
    "methodology": "Fun-DDPS (Function-Space Decoupled Diffusion for CCS) is a two-brained approach that tackles forward and inverse problems in subsurface flow by separating the roles of a geological prior and a physics engine. Think of it as having a “sculptor” that learns what realistic geology looks like (the diffusion model over geomodels) and a fast, differentiable simulator (the Local Neural Operator) that tells you how the flow responds to those geologies. The key twist is that these two pieces are decoupled: the diffusion model focuses on the space of possible geologies, while the neural operator focuses on the flow dynamics and how observations should inform changes to those geologies.\n\nHere is the high-level workflow conceptually:\n- Build a prior over geological parameters using a diffusion model trained on examples of subsurface structures. This is like teaching the system what a plausible underground world looks like, so even with sparse data it can still “imagine” reasonable shapes.\n- Use a Local Neural Operator as a differentiable surrogate for the forward physics (how fluids move through the rock) and for guiding the inverse problem. This acts like a fast, learned physics engine that can provide gradient information without expensive simulations.\n- Combine the two in a way that keeps their strengths separate. The diffusion prior robustly fills in missing information in the parameter space (geology), while the neural operator provides physics-consistent cues to steer the data-fitting process.\n- Perform data assimilation by nudging diffusion-generated samples toward observations, using the surrogate’s guidance to ensure the updates respect physical rules and remain smooth rather than creating noisy, high-frequency artifacts.\n\nWhy this decoupling helps, especially for CCS problems with sparse data: the diffusion model gives you realistic geological realizations even when observations are few, so you don’t have to rely on brittle, overfitted maps of the subsurface. The neural operator, being a fast and differentiable surrogate, offers practical gradient-based guidance to fit the data without running costly, high-fidelity simulations every time. Because the two pieces aren’t trying to solve everything at once, the method avoids some common pitfalls (like spurious high-frequency artifacts) and achieves better efficiency.\n\nIn short, Fun-DDPS delivers two concrete wins: it enables accurate forward predictions with only 25% of observations (much better than standard surrogates), and it provides a principled inverse-solver that matches near-exact posteriors with strong statistical agreement while being about four times more sample-efficient than traditional rejection sampling. The approach represents a conceptually clean way to fuse a learned geological prior with a physics-informed, differentiable surrogate to tackle the ill-posed inverse problems that are central to CCS studies.",
    "results": "Fun-DDPS is a new way to predict how fluids move underground when we only have limited data. It does this by combining two ideas that work well together but play different roles. First, it learns a prior—what realistic underground properties look like—by using a diffusion model that captures the common patterns in geology. Second, it uses a Local Neural Operator, a fast, physics-informed tool, to guide how those properties should behave when fluids flow and how to adjust them when we observe data. Think of it as a two-person team: one person imagines plausible underground layouts from learned patterns, while the other checks those ideas against how the physics of flow actually works and helps tweak them quickly.\n\nIn tests that mimic real-world carbon storage scenarios, Fun-DDPS shines especially when data are sparse. It can produce forward predictions that stay plausible even when only a small fraction of observations are available, performing far better than standard surrogate methods that don’t use this learned geological prior. For the inverse problem—figuring out the underground properties from measurements—the method comes very close to what you would get if you could compute the exact theoretical solution, while avoiding the unrealistic high-frequency artifacts that some other joint-state approaches produce. Importantly, these gains come with much less computational effort than traditional sampling-based methods, making it practical to use in real projects.\n\nWhy this matters is simple: predicting subsurface flow reliably with limited data is a major challenge for carbon capture and storage, and mispredictions can be costly or unsafe. By decoupling the learning of geological patterns from the physics-guided data assimilation, Fun-DDPS provides more robust, physically consistent results and works well even when observations are scarce. The work also sets a new benchmark by showing diffusion-based solvers can match the quality of theoretically exact posteriors in this domain, which helps build confidence that these advanced AI tools can be trusted for important engineering decisions.",
    "significance": "This paper matters today because it tackles a stubborn problem in subsurface science: how to infer hidden geological parameters when you only have a few noisy measurements. In Carbon Capture and Storage (CCS), knowing the underground properties is crucial for predicting how CO2 will move and where it might leak. Traditional methods can fail or require a lot of data and computation. Fun-DDPS changes the game by splitting the problem into two pieces: a diffusion model that learns a prior over geological parameters (the geomodel) and a differentiable neural-operator surrogate that guides the forward physics. This decoupling lets the method fill in missing information in parameter space and still respect the physics when updating with data, which is exactly what you want when observations are sparse.\n\nIn the long run, this work offers a lasting blueprint for how to combine generative models with physics-based surrogates to solve forward and inverse problems in science and engineering. The idea of a function-space prior (the diffusion model over geomodels) paired with a fast, differentiable operator (the Local Neural Operator) can be adapted to many PDE-driven domains beyond CCS, such as groundwater flow, reservoir simulation, seismic inversion, or climate and materials modeling. It also points toward more reliable uncertainty quantification: Fun-DDPS and its variants show accurate posteriors and physically plausible samples with much better data efficiency than traditional rejection-sampling approaches. As researchers push toward real-time data assimilation and decision-making in complex systems, this function-space + physics-guided approach provides a scalable path to robust, interpretable inferences with limited data.\n\nLinking to modern AI systems people know, this work sits at a bridge between diffusion-era generative modeling and physics-informed machine learning. Diffusion models are now famous in image and video generation; here they’re repurposed as priors over plausible subsurface worlds, guiding inversions with minimal data. The neural-operator surrogate is a partner tool—like a fast, differentiable “physics engine” that keeps the results physically consistent and accelerates gradient-based updates. This mirrors how contemporary AI systems use modular tools and differentiable engines to incorporate domain knowledge and constraints. For CCS and other fields, you might see this approach appear in data assimilation workflows, reservoir-management toolchains, or geoscience software that seeks uncertainty-aware, computation-efficient forward/inverse solvers. In short, Fun-DDPS matters because it offers a practical, scalable way to reason about uncertain physical systems when data are scarce, a challenge that will remain central as AI and science mix more tightly in the years ahead."
  },
  "concept_explanation": {
    "title": "Understanding Function-space Diffusion: The Heart of Function-Space Decoupled Diffusion for Forward and Inverse Modeling in Carbon Capture and Storage",
    "content": "Imagine you’re trying to reconstruct a detailed landscape map from only a few scattered landmarks. You know that in the real world, geology tends to have smooth layers, special structures (like faults), and realistic patterns. A function-space diffusion approach is like teaching a “memory” of landscapes: a model learns what plausible geological fields look like in general, then uses that memory to fill in the missing parts in a way that stays believable. Here, the memory is a diffusion model that operates not on pictures, but on functions—specifically, the spatial maps of geological properties (the geomodel) that describe subsurface rocks.\n\nStep by step, how it works:\n- The diffusion model treats the geomodel as a function defined over space (a grid of permeability, porosity, etc.). During training, it gradually adds noise to many such geomodels and learns how to denoise them back to their original shapes. After training, you can sample new realistic geomodels by starting from pure noise and repeatedly denoising, building a prior distribution over plausible subsurface maps.\n- Separately, a Local Neural Operator (LNO) surrogate is trained to emulate the physics that links a geomodel to how fluids move and what the pressure or saturation fields look like. The LNO is differentiable, so it can tell you how small changes in the geomodel would change those dynamics.\n- The overall idea is to decouple two parts: use the diffusion prior to keep the inferred geomodels realistic (the “what can exist” part), and use the LNO surrogate to guide data fitting with physics-consistent gradients (the “how to fit the data” part). This makes it easier to handle sparse data while staying faithful to physics.\n\nHow the two pieces work together during inference:\n- For forward modeling with limited observations (like only 25% of the data available), you start from the diffusion prior to sample plausible geomodels. You then run the LNO to predict the resulting flow and observation fields, compare them to what you actually observed, and compute a gradient-based update to the geomodel. Because the prior keeps the field within realistic geologies, the method can recover missing features that purely data-driven models would miss or distort.\n- For inverse modeling, you can condition the diffusion process on the observed data, effectively sampling from a posterior over geomodels that both explains the measurements and remains geologically plausible. The paper shows that this diffusion-based inverse solver aligns well with exact (but expensive) rejection-sampling posteriors and produces physically consistent realizations, avoiding high-frequency artifacts that some joint approaches generate. In short, you get good uncertainty estimates with far fewer samples.\n\nWhy this is important and where it helps:\n- Subsurface characterization for CCS (carbon capture and storage) is notoriously ill-posed because we have sparse measurements underground. Fun-DDPS gives a robust way to reconstruct plausible geological maps and the corresponding flow fields even when data are scarce, which improves predictions of how injected CO2 will move and be stored.\n- The approach isn’t limited to CCS. Any field that combines complex physics with limited observations—groundwater management, oil and gas reservoir planning, contamination plume tracking, or environmental monitoring—can benefit from a function-space diffusion prior plus a physics-guided neural-operator surrogate. Practically, this means better uncertainty estimates, fewer unphysical artifacts in reconstructions, and faster, more reliable data assimilation than traditional methods or purely data-driven models."
  },
  "summary": "This paper introduces Fun-DDPS, a decoupled framework that combines a diffusion-based prior over geological parameters with a differentiable neural-operator surrogate to jointly enable forward modeling and inverse data assimilation in carbon capture and storage, achieving accurate results under extreme data sparsity, producing physically consistent realizations, and delivering substantially higher sample efficiency than rejection sampling.",
  "paper_id": "2602.12274v1",
  "arxiv_url": "https://arxiv.org/abs/2602.12274v1",
  "categories": [
    "cs.LG",
    "physics.geo-ph"
  ]
}